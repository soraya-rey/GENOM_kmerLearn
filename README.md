# GENOM Project: Comprehensive Analysis of Prokaryotic Genomes Using k-mers Distribution

**Authors:** Maëlys Delouis, Soraya Rey, Lorenzo Ballestra  
**Date:** January 2024

## Overview
This project focuses on the large-scale analysis of prokaryotic genomes using k-mer distribution profiles. With the exponential increase in genomic data generated by high-throughput sequencing technologies, developing efficient and space-saving representations of this data has become crucial. This project explores the potential of k-mer profiles for classifying genes of unknown origin by species, leveraging machine learning and deep learning techniques.

## Objective
The primary objective of this project is to classify unknown genes based on the k-mer profiles of genomes. We employed four different methods for classification:

1. **Distance Between Profiles** – Implemented in `kmer_distances.ipynb`
2. **Support Vector Machines (SVM)** – Implemented in `SVM.ipynb`
3. **Convolutional Neural Network (CNN) on Frequency Profiles** – Implemented in `classifiers/CNN_with_frequency_matrix/CNN_with_frequency_matrix.ipynb`
4. **CNN on Chaos Game Representation (CGR)** – Implemented in `CNN_on_CGR.ipynb`

## Data Collection and Preprocessing
A comprehensive database of complete genomes, genes, and proteins was constructed for various selected bacterial and archaeal species using Python scripts. To reduce data size and training time, only species with complete genomes were included, and a random selection of 50 genes and proteins per species was made. The genomic sequences were converted into k-mer profiles (3-mers, 5-mers, 6-mers, and 8-mers). A binary encoding scheme was applied to the genomic data and protein sequences, though limitations in data size prevented the inclusion of 8-mers in the final dataset.

## Visualization and Representation
To visualize the k-mer profiles, two methods from the literature were implemented: frequency/occurrence spectra and Chaos Game Representations (CGR). While the former aids in profile visualization, the latter was used as input for convolutional neural networks (CNNs) to detect patterns in the data.

## Classification Methods
Several classification approaches were explored to create a benchmark and determine the most suitable method for this dataset:

1. **Euclidean Distance Between Profiles**: Each species is represented by a point in k-mer space (4^k or 20^k dimensions). Gene classification is performed by finding the species minimizing the Euclidean distance between its genome’s k-mer profile and that of the unknown gene.
  
2. **Support Vector Machines (SVM)**: SVMs were used to extend the data space to achieve separability. A linear kernel was used with a regularization parameter (C=100) to optimize accuracy.

3. **Convolutional Neural Network (CNN)**: Inspired by previous work, CNNs were employed to extract features from the k-mer frequency profiles and classify genes. The model consisted of convolutional layers followed by dense layers for classification.

4. **CNN on CGR**: Genome and gene sequences were converted into CGRs, significantly reducing the dataset size. A simple CNN model was created using 2D convolution with a kernel size of 3, followed by dropout, and a dense layer for classification.


## File Structure and Code Explanation

### 1. **Data Creation Pipeline**
   - The pipeline for creating the genomic, gene, and protein database is located in `database/script.py`. This script handles the downloading of complete genomes and the creation of datasets for analysis.
   
### 2. **Profile Generation**
   - Scripts for generating k-mer profiles for different datasets (genomes, genes, proteins) are located in `kmer_profiler/`:
     - **Genome profiles**: `kmer_profiler/generate_profiles.py`
     - **Gene profiles**: `kmer_profiler/generate_gene_profiles.py`
     - **Protein profiles**: `kmer_profiler/generate_protein_profiles.py`

### 3. **Profile-Based Classifications**
   - **Distance Between Profiles**: Implemented in the notebook `kmer_distances.ipynb`. This method classifies unknown genes based on the Euclidean distance between the k-mer profiles of the genomes and the genes.
   - **SVM Classification**: Implemented in the notebook `SVM.ipynb`. This notebook contains the implementation of Support Vector Machine models for classifying genes based on k-mer profiles.
   - **CNN with Frequency Matrix**: Implemented in the notebook `classifiers/CNN_with_frequency_matrix/CNN_with_frequency_matrix.ipynb`. This method utilizes a Convolutional Neural Network (CNN) to classify genes by extracting features from the k-mer frequency matrix.
   - **CNN on Chaos Game Representation (CGR)**: Implemented in `CNN_on_CGR.ipynb`. This method converts genome and gene sequences into CGR images, which are then classified using a CNN model.

### 4. **CGR Image Generation**
   - The code to generate Chaos Game Representation (CGR) images from genome sequences is found in the notebook `kmer_CGR.ipynb`. These images serve as input to the CNN for classification.

### 5. **Training Data**
   - The profiles used for training the different classification methods (k-mer profiles and CGR images) are included in the respective notebooks and scripts.


## Results and Conclusions
The performance of the different methods was evaluated based on accuracy and computational time for k-mer profiles of lengths 3, 5, and 6 (nucleotide sequences) as well as 3-mers for proteins. The best-performing method was the CNN applied to CGRs, achieving an accuracy of 0.93 in cross-validation on 5-mers. However, training CNNs on full genome profiles also yielded high accuracy, although this did not allow for cross-validation.

The Euclidean distance method proved to be the fastest in terms of computation time due to its simplicity. Larger k-mer sizes generally yielded better results but also increased training time. We found that 5-mers for nucleotides provided a good balance between classification accuracy and computational efficiency.

While CNNs performed well, they were computationally expensive due to the need to generate images (CGRs) from the sequences. The SVM, when trained on full genomes, yielded poor results due to the high dimensionality of the data. Protein-based k-mer profiles did not perform well in classification tasks, likely due to the sparse nature of the k-mer profiles for proteins.

This project highlights the potential of k-mer profiles and CGRs for genome classification tasks, though it also points to the challenges posed by large datasets and high-dimensional spaces in machine learning applications.
